Stroke←{
    joined←,[0.5]⌿↑2↑⊂⍣(2=≡⍺)⊢⍺
    (left mid)←≢⍤⍉¨¯1↓joined
    (keys nums)←↓⊃,/joined
    Error←{⎕SIGNAL 11}
    indices←('-'≠⍵)/+\⊃{
        drop←+/⍵
        '-'=⍺:⍵,Error⍣(index<mid)        ⊢index←drop-⍨left+mid
              ⍵,Error⍣(index>drop-⍨≢keys)⊢index←keys⌊⍥(⍺⍳⍨drop∘↓)nums
    }/(⌽⍵),⊂⍬
    ('#'=keys)∨⍣(∨/⍵∊nums)⊢(≢keys)↑⍸⍣¯1⊢indices
}
